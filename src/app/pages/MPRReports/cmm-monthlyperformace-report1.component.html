<div class="row">
    <div class="col-md-4"><h4>Monthly Report 1</h4></div>
    <div class="col-md-6"></div>
    <div class="col-md-2 text-right">
      <i class="fa fa-plus-square expand" aria-hidden="true" (click)="showHideFilterBlock()" pTooltip="Expand Filters"></i>
    </div>
  </div>
  <div *ngIf="showFilterBlock" class="form-control" style="height:100%;border-radius:0px;padding:30px">
    <div class="row form-group">
      <div class="col-lg-3 col-md-3 col-sm-3">
        <label class="form-label">FROM</label><br />
        <input type="date" class="form-control" [(ngModel)]="report.Fromdate">
      </div>
      <div class="col-lg-3 col-md-3 col-sm-3">
        <label class="form-label">TO</label>&nbsp;<br />
        <input type="date" class="form-control" [(ngModel)]="report.Todate">
      </div>
      <div class="col-lg-3 col-md-3 col-sm-3">
        <mat-form-field style="width:100%">
          <mat-label>Select BuyerGroup</mat-label>
          <select matNativeControl [(ngModel)]="report.BuyerGroupId">
            <option value="" selected></option>
            <option *ngFor="let option of buyergroups" [value]="option.BuyerGroupId">
              {{option.BuyerGroup}}
            </option>
          </select>
        </mat-form-field>
      </div>
      <div class="col-lg-3 col-md-3 col-sm-3">
        <mat-form-field style="width:100%">
          <mat-label>Select Department</mat-label>
          <select matNativeControl [(ngModel)]="report.DepartmentId">
            <option value="" selected></option>
            <option *ngFor="let option of Orgdepartments" [value]="option.DepartmentId">
              {{option.Department}}
            </option>
          </select>
        </mat-form-field>
      </div>
      
    </div>
    
    <div class="row">
      <div class="col-md-12" style="text-align:center">
        <button type="button" class="btn btn-primary" (click)="GetCMMMonthlyPerformancereport1(report)">Submit</button>&nbsp;&nbsp;
      </div>
    </div>
  </div>
  <br />
  <i class="fa fa-file-excel-o" aria-hidden="true" style="font-size:x-large"  (click)="ExportTOExcel()" pTooltip="ExportTOExcel"></i>

  <!-- <div class="card compar-card mt-2">
  <div class="card-body" style="overflow-y: scroll; width:100%;padding-top:7px;overflow-x:scroll">
    <table class="table table-sm table-striped table-bordered" #TABLE #table>
      <thead class="thead-dark">
        <tr style="background-color: #33b5e5">
          <th style="width:200px">S.No</th>
          <th style="width:200px">MPR NO</th>
          <th style="width:200px">MPR APPROVED DATE</th>
          <th style="width:200px">MPR ACKNOWLEDGED DATE</th>
          <th style="width:200px">TECHNICAL CLEARANCE DATE</th>
          <th style="width:200px">PA NO</th>
          <th style="width:200px">PA GENERATED BY</th>
          <th style="width:200px">PA GENERATED DATE</th>
          <th style="width:200px">NO OF LINE ITEMS</th>
          <th style="width:200px">VENDOR NAME</th>
          <th style="width:200px">BUYER GROUP</th>
          <th style="width:200px">DEPARTMENT</th>
          <th style="max-width:300px !important" >NO OF DAYS TAKEN FROM ACKNOWLEDGEMENT DATE TO PA DATE</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let app of statuslist  let ndx = index">
          <td>{{ndx+1}}</td>
          <td>{{app.MPRNO}}</td>
          <td>{{app.approvedate|date: 'dd.MM.yyyy'}}</td>
          <td style="max-width:300px !important">{{app.ACKDate|date: 'dd.MM.yyyy'}}</td>
          <td>{{app.ACKDate|date: 'dd.MM.yyyy'}}</td>
          <td>{{app.PAId}}</td>
          <td>{{app.PAGeneratedBy}}</td>
          <td>{{app.PACreattionDate|date: 'dd.MM.yyyy'}}</td>
          <td>{{app.NoofLineItems}}</td>
          <td>{{app.VendorName}}</td>
          <td>{{app.BuyerGroup}}</td>
          <td>{{app.Department}}</td>
          <td>{{app.NoofDays}}</td>
        </tr>
      </tbody>
    </table>
  </div> -->
  <div class="card compar-card mt-3">
    <div class="card-body" style="overflow:auto !important" #TABLE>
      <p-table #dt [value]="statuslist" [style]="{'width':'100%','overflow':'auto!important'}"
               [responsive]="true" [rows]="50"
               [resizableColumns]="true"
               columnResizeMode="expand"
               [paginator]="true" [rowsPerPageOptions]="[25,50,75,100]"
               appendTo="body">
        <ng-template pTemplate="header">
          <tr class="mprltbldata">
            <th style="width:100px">S.No</th>
            <th style="width:110px">MPR NO</th>
            <th style="width:100px">MPR APPROVED DATE</th>
            <th style="width:100px">MPR ACKNOWLEDGED DATE</th>
            <th style="width:100px">TECHNICAL CLEARANCE DATE</th>
            <th style="width:100px">PA NO</th>
            <th style="width:100px">PA GENERATED BY</th>
            <th style="width:100px">PA GENERATED DATE</th>
            <th style="width:100px">NO OF LINE ITEMS</th>
            <th style="width:100px">VENDOR NAME</th>
            <th style="width:100px">BUYER GROUP</th>
            <th style="width:100px">DEPARTMENT</th>
            <th style="width:100px">NO OF DAYS TAKEN FROM ACKNOWLEDGEMENT DATE TO PA DATE</th>
          </tr>
        </ng-template>
        <ng-template pTemplate="body" let-rowData let-editing="editing" let-ri="rowIndex" let-rindex=0>
          <tr class="mprltbldata">
            <td> {{ri+1}}</td>
            <td class="ptable-cell"><a [routerLink]="['/SCM/MPRForm',rowData.RevisionId]" target="_blank" routerLinkActive="active">{{rowData.MPRNO}}</a></td>
            <td class="ptable-cell">{{rowData.approvedate |date: 'dd.MM.yyyy'}}</td>
            <td class="ptable-cell">{{rowData.ACKDate |date: 'dd.MM.yyyy'}}</td>
            <td class="ptable-cell">{{rowData.ACKDate |date: 'dd.MM.yyyy'}}</td>
            <td class="ptable-cell">
              <!-- <span *ngIf="!showPALink">{{rowData.PAId}}</span> -->
              <a  [routerLink]="['/SCM/mprpa',rowData.PAId]" target="_blank" routerLinkActive="active">{{rowData.PAId}}</a></td>
            <td class="ptable-cell">{{rowData.PAGeneratedBy}}</td>
            <td class="ptable-cell">{{rowData.PACreattionDate |date: 'dd.MM.yyyy'}}</td>
            <td class="ptable-cell">{{rowData.NoofLineItems}}</td>
            <td class="ptable-cell">{{rowData.VendorName}}</td>
            <td class="ptable-cell">{{rowData.BuyerGroup}}</td>
            <td class="ptable-cell">{{rowData.Department}}</td>
            <td class="ptable-cell">{{rowData.NoofDays}}</td>
          </tr>
        </ng-template>
      </p-table>
    </div>
</div>